{"uid":"6565327815e35737","name":"测试添加用户接口","fullName":"test_cases.api.system_manager.users.test_add_user_management.TestUserManagement#test_add_user","historyId":"592d77fea9d38e1bd03f015dcc9e648b","time":{"start":1743952877487,"stop":1743952877501,"duration":14},"description":"\n        测试添加用户API接口\n        ","descriptionHtml":"<pre><code>    测试添加用户API接口\n</code></pre>\n","status":"failed","statusMessage":"AssertionError: 添加用户失败，状态码: 400\nassert 400 in [200, 201]\n +  where 400 = <Response [400]>.status_code","statusTrace":"self = <test_cases.api.system_manager.users.test_add_user_management.TestUserManagement object at 0x103e674f0>\napi_client = <common.api_client.ApiClient object at 0x103e67c40>\n\n    @allure.story(\"用户管理\")\n    @allure.title(\"测试添加用户接口\")\n    def test_add_user(self, api_client):\n        \"\"\"\n        测试添加用户API接口\n        \"\"\"\n        # 设置请求参数\n        endpoint = \"api/users\"\n        payload = {\n            \"username\": \"testuser\",\n            \"name\": \"测试用户\",\n            \"phone\": \"13800138000\",\n            \"email\": \"test@example.com\",\n            \"sex\": \"man\",\n            \"roles\": [1],  # 使用1作为角色ID，确保该角色存在\n            \"is_active\": True\n        }\n    \n        # 添加测试步骤\n        with allure.step(\"发送添加用户请求\"):\n            allure.attach(json.dumps(payload, ensure_ascii=False, indent=2),\n                         \"请求参数\", allure.attachment_type.JSON)\n            response = api_client.post(endpoint, json_data=payload)\n    \n        # 记录响应结果\n        with allure.step(\"获取响应结果\"):\n            allure.attach(response.text, \"响应内容\", allure.attachment_type.TEXT)\n            allure.attach(str(response.status_code), \"状态码\", allure.attachment_type.TEXT)\n    \n        # 断言响应状态码\n        with allure.step(\"验证响应状态码\"):\n>           assert response.status_code in [200, 201], f\"添加用户失败，状态码: {response.status_code}\"\nE           AssertionError: 添加用户失败，状态码: 400\nE           assert 400 in [200, 201]\nE            +  where 400 = <Response [400]>.status_code\n\ntest_cases/api/system_manager/users/test_add_user_management.py:47: AssertionError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"api_client","time":{"start":1743952877303,"stop":1743952877487,"duration":184},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"\n        测试添加用户API接口\n        ","status":"failed","statusMessage":"AssertionError: 添加用户失败，状态码: 400\nassert 400 in [200, 201]\n +  where 400 = <Response [400]>.status_code","statusTrace":"self = <test_cases.api.system_manager.users.test_add_user_management.TestUserManagement object at 0x103e674f0>\napi_client = <common.api_client.ApiClient object at 0x103e67c40>\n\n    @allure.story(\"用户管理\")\n    @allure.title(\"测试添加用户接口\")\n    def test_add_user(self, api_client):\n        \"\"\"\n        测试添加用户API接口\n        \"\"\"\n        # 设置请求参数\n        endpoint = \"api/users\"\n        payload = {\n            \"username\": \"testuser\",\n            \"name\": \"测试用户\",\n            \"phone\": \"13800138000\",\n            \"email\": \"test@example.com\",\n            \"sex\": \"man\",\n            \"roles\": [1],  # 使用1作为角色ID，确保该角色存在\n            \"is_active\": True\n        }\n    \n        # 添加测试步骤\n        with allure.step(\"发送添加用户请求\"):\n            allure.attach(json.dumps(payload, ensure_ascii=False, indent=2),\n                         \"请求参数\", allure.attachment_type.JSON)\n            response = api_client.post(endpoint, json_data=payload)\n    \n        # 记录响应结果\n        with allure.step(\"获取响应结果\"):\n            allure.attach(response.text, \"响应内容\", allure.attachment_type.TEXT)\n            allure.attach(str(response.status_code), \"状态码\", allure.attachment_type.TEXT)\n    \n        # 断言响应状态码\n        with allure.step(\"验证响应状态码\"):\n>           assert response.status_code in [200, 201], f\"添加用户失败，状态码: {response.status_code}\"\nE           AssertionError: 添加用户失败，状态码: 400\nE           assert 400 in [200, 201]\nE            +  where 400 = <Response [400]>.status_code\n\ntest_cases/api/system_manager/users/test_add_user_management.py:47: AssertionError","steps":[{"name":"发送添加用户请求","time":{"start":1743952877487,"stop":1743952877500,"duration":13},"status":"passed","steps":[],"attachments":[{"uid":"728fdb1fdca2ac23","name":"请求参数","source":"728fdb1fdca2ac23.json","type":"application/json","size":172}],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},{"name":"获取响应结果","time":{"start":1743952877500,"stop":1743952877500,"duration":0},"status":"passed","steps":[],"attachments":[{"uid":"ca9c415c5f45b0e0","name":"响应内容","source":"ca9c415c5f45b0e0.txt","type":"text/plain","size":41},{"uid":"7be00451809242bb","name":"状态码","source":"7be00451809242bb.txt","type":"text/plain","size":3}],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":2,"hasContent":true,"attachmentStep":false},{"name":"验证响应状态码","time":{"start":1743952877500,"stop":1743952877500,"duration":0},"status":"failed","statusMessage":"AssertionError: 添加用户失败，状态码: 400\nassert 400 in [200, 201]\n +  where 400 = <Response [400]>.status_code\n","statusTrace":"  File \"/Users/Apple/PycharmProjects/himool_auto_case/test_cases/api/system_manager/users/test_add_user_management.py\", line 47, in test_add_user\n    assert response.status_code in [200, 201], f\"添加用户失败，状态码: {response.status_code}\"\n","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[{"uid":"796b2dd7775d40ab","name":"log","source":"796b2dd7775d40ab.txt","type":"text/plain","size":405},{"uid":"ac2e8f372294557c","name":"stderr","source":"ac2e8f372294557c.txt","type":"text/plain","size":411}],"parameters":[],"shouldDisplayMessage":true,"stepsCount":3,"attachmentsCount":5,"hasContent":true,"attachmentStep":false},"afterStages":[],"labels":[{"name":"feature","value":"系统管理"},{"name":"epic","value":"API测试"},{"name":"story","value":"用户管理"},{"name":"parentSuite","value":"test_cases.api.system_manager.users"},{"name":"suite","value":"test_add_user_management"},{"name":"subSuite","value":"TestUserManagement"},{"name":"host","value":"MacBook-Pro.local"},{"name":"thread","value":"82653-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"test_cases.api.system_manager.users.test_add_user_management"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":true,"retry":true,"extra":{"categories":[],"tags":[]},"source":"6565327815e35737.json","parameterValues":[]}